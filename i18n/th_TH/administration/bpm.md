# การจัดการ กระบวนการ ทางธุรกิจ

การจัดการกระบวนการทางธุรกิจ (BPM) ให้ความสามารถ ในการจำลองและดำเนินการกระบวนการ ทางธุรกิจโดยอัตโนมัต ิใน EspoCRM  เป็นเครื่องมืออที่ดำเนิน การกระบวนการทางธุรกิจ ที่อธิบายไว้ ในมาตรฐาน BPMN 2.0  BPM เครื่องมือมีอยู่ใน [Advanced Pack](https://www.espocrm.com/extensions/advanced-pack/) ส่วนขยาย.

![BPM example](https://raw.githubusercontent.com/espocrm/documentation/master/_static/images/administration/bpm/bpm-1.png)

### ความแตกต่างจาก Workflows tool 

Workflows tool มีไว้สำหรับการดำเนินธุรกิจ โดยใช้กฎเกณฑ์ ทางธุรกิจที่เรียบง่าย, w / o รายการไหลเวียนตามลำดับ, เมื่อไม่ต้องการให้แสดงการไหลแบบกราฟิก

BPM tool มีไว้ สำหรับการดำเนินธุรกิจ ที่ซับซ้อนมากยิ่่งขึ้น, ซึ่งอาจมีการกระจายและการไหลเวียนเกิดขึ้นได้, ความล่าช้า ในการดำเนินการ, ปฏิสัมพันธ์ของผู้ใช้งาน ,มุมมองของผังงาน ทำให้กระบวนการทางธุรกิจเข้าใจได้ง่ายขึ้น สำหรับมนุษย์, การบันทึกช่วยให้เห็นถึง วิธีการจัดกระบวนการ

## กระบวนการ Flowcharts

การเชื่อมโยงไปที่กระบวนการ flowcharts สามารถใช้งานได้ จากแผงการบริหาร  นอกจากนี้ ยังสามารถเพิ่มแท็บใน navigation panel.

Flowcharts มีไว้สำหรับการสร้างแบบจำลองของ กระบวนการทางธุรกิจ โดยผู้ดูแลระบบสามารถสร้างและแก้ไข flowcharts ได้ ผู้ใช้ทั่วไปสามารถดู flowcharts ได้เท่านั้น .

ทุก flowchart มีประเภทที่เฉพาะเจาะจง (Target Type field).  flowchart กำหนดกระบวนทำงานของ instances ในอนาคต ซึ่งประกอบไปด้วยองค์ประกอบของ Flowchart และการเชื่อมต่อระหว่าง องค์ประกอบต่างๆ

หากกระบวนการผังงานมีฟิลด์ที่ 'ใช้งานอยู่' ยังไม่ถูกตรวจสอบ ระบบจะไม่เริ่มต้น initiate ของกระบวนการ

หากต้องการแสดงรายละเอียดและพารามิเตอร์ขององค์ประกอบ flowchart ที่ต้องการคลิก ในโหมดแก้ไขคุณจะสามารถแก้ไข parameters ได้

## กระบวนการ
  
กระบวนการที่มีอยู่จากแผงการบริหาร การเชื่อมโยงนี้ สามารถเพิ่มเป็นแท็บ ในแผงการนำทาง

โดยกระบวนการ จะแสดงถึงกระบวนการทางธุรกิจ เมื่อเริ่มต้นแล้วจะมีสถานะเป็น 'เริ่ม' เมื่อกระบวนการสิ้นสุดลงแล้ว จะมีสถานะเป็น 'จบ' กระบวนการนี้ สามารถหยุด ด้วยตนเอง โดยผู้ใช้ที่มีสิทธิ์เข้าถึง เพื่อแก้ไขกระบวนการได้ หากระบบหยุดด้วยตนเอง จะมีสถานะเป็นสถานะ "หยุด"

กระบวนการดำเนินการตาม flowchart  ไม่สามารถเปลี่ยนแปลง กระบวนการของ Flowchart หลังจากเริ่ม กระบวนการ ไปแล้ว
โดย กระบวนการ จะเกี่ยวข้องกับบันทึกเป้าหมาย เพียงอย่างเดียว

กระบวนการ สามารถเริ่มต้นได้ โดยอัตโนมัติ (ตามเงื่อนไขที่ระบุหรือตามเวลา) หรือด้วยตนเอง (ที่มีกิจกรรมเริ่มต้นอย่างน้อยหนึ่งอย่าง ในผังงาน) เมื่อต้องการเริ่มกระบวนการด้วยตนเองผู้ใช้ต้องคลิกที่ปุ่ม 'เริ่มกระบวนการ' ในมุมมองรายการของกระบวนการ


## องค์ประกอบของ Flowchart 

### เหตุการณ์

เหตุการณ์ จะปรากฏใน flowchart เป็นวงเวียน

#### เริ่มเหตุการณ์

ไม่มี parameters เป็นจุดเริ่มต้นของกระบวนการ เหตุการณ์เริ่มต้นสามารถ เริ่มต้นด้วยตนเอง โดยที่ผู้ใช้มีสิทธิ์เข้าถึง เพื่อสร้างกระบวนการ ผู้ใช้ต้องคลิกที่ปุ่ม 'เริ่มกระบวนการ' ในมุมมองรายการของกระบวนการ

#### เงื่อนไข เหตุการณ์เริ่มต้น

จุดเริ่มต้นของกระบวนการ จะเรียกใช้โดยอัตโนมัติเมื่อมีการระบุเงื่อนไขเกิดขึ้น มี trigger สองแบบ คือ : 'สร้าง หลังจากบันทึก', 'บันทึก หลังจากบันทึกแล้ว'


#### เหตุการณ์ เริ่มจับเวลา

จุดเริ่มต้นของกระบวนการ คือ  เริ่มต้นกระบวนการโดยกำหนดเวลา คุณต้องระบุ รายการของรายงานที่จะส่งกลับบันทึก สำหรับการเริ่มต้น กระบวนการและการตั้งเวลาในเอกสาร crontabA 

#### เงื่อนไขของ เหตุการณ์ ระดับกลาง

กิจกรรมนี้จะหยุดการไหลจนกว่าจะมีการระบุเกณฑ์

#### เหตุการณ์ ระดับกลาง ของตัวจับเวลา

เหตุการณ์นี้ จะหยุดการไหลและรอจนกว่าจะมีการระบุจาก parameters ของเหตุการณ์ 

สำหรับการตั้งค่าตัวจับเวลาที่ซับซ้อนยิ่งขึ้นคุณสามารถใช้ประโยชน์ได้ [formula](formula.md) สูตรสคริปต์ ควรจะส่งคืนค่าวันที่-เวลา (ในเขตเวลา UTC) เมื่อถึงเวลาการไหล จะดำเนินต่อไป พร้อมกับองค์ประกอบถัดไป

เมื่อใช้ฟังก์ชันสูตรที่ใกล้เคียงกับ วันเวลา \ คุณสามารถตั้งเวลาให้กับช่วงเวลาที่ต้องการได้ในอนาคต เช่น จุดเริ่มต้นของวันทำการในวันถัดไป 

#### เหตุการณ์ สิ้นสุด

สิ้นสุด flow ของกระแส มันไม่ได้จบลงที่ flow วิ่งขนาน เมื่่อ flow ถึงเหตุการณ์ สิ้นสุดและไม่มีอะไรที่ทำงานแบบขนาน กระบวนการจึงจะ สิ้นสุดลง

#### ยุติ เหตุการณ์ ที่สิ้นสุด

เมื่อจบ flows ทั้งหมด กระบวนการจะสิ้นสุดลงในภายหลัง

### Gateways

Gateways จะแสดง เป็นรูปข้าวหลามตัด

#### Gateway แบบพิเศษ

สามารถแยกแยะหรือ บรรจบกันของ flows ได้ .

ในกรณีที่แยกออกจากกันจะกำหนดเส้นทางของ flow (เส้นทาง) เดี่ยวที่จะเลือกตามเกณฑ์ที่ระบุ  เงื่อนไขแรกที่่พบ คือ จะกำหนด flow, ถัดไป เงื่อนไขจะถูกละไว้. มีความสามารถในการระบุ flow เริ่มต้น ซึ่ง flow เริ่มต้นจะ ถูกเลือกหากไม่มีเงื่อนไขใด ๆ ที่ตรงตามเงื่อนไขที่กำหนดไว้ flow เริ่มต้น ถูกทำเครื่องหมายด้วย เครื่องหมายทับ

ในกรณีของการบรรจบกันเพียงแค่นำ flow ไปยังองค์ประกอบที่ส่งออก จะไม่ได้รับการปิดกั้น แม้ว่าหลังจาก flow มา ดังนั้นกระแสคู่ขนานจะไม่ถูกผสานเข้ากับ flow 

![exclusive gateway divergent](https://raw.githubusercontent.com/espocrm/documentation/master/_static/images/administration/bpm/gateway-exclusive-divergent.png)

![exclusive gateway convergent](https://raw.githubusercontent.com/espocrm/documentation/master/_static/images/administration/bpm/gateway-exclusive-convergent.png)

#### Inclusive Gateway

สามารถแยกแยะ หรือ บรรจบกัน ของ flows ได้ 

ในกรณีที่มีการแบ่งแยกออกไป มันสามารถนำไปสู่ flows คู่ขนานได้ (path) โดยขึ้นอยู่กับความสำเร็จของเกณฑ์ flows แต่ละครั้ง และ flows เริ่มต้น จะถูกเลือกหากไม่มีเงื่อนไขใด ๆ ที่ตรงตามเงื่อนไข กระแสเริ่มต้นถูกทำเครื่องหมายด้วยเครื่องหมายทับ


![inclusive gateway](https://raw.githubusercontent.com/espocrm/documentation/master/_static/images/administration/bpm/gateway-inclusive.png)

หมายเหตุ:gateways การแบ่งและการรวมกันต้องมีความสมดุล

หมายเหตุ: หาก flows แบบคู่ขนานสิ้นสุดลง ด้วยเหตุผลบางประการ gateway ที่แยกกันจะไม่ได้รับการประมวลผล และกระบวนการนี้จะถูกปิดกั้น หลีกเลี่ยงการออกแบบ flowchart ที่สามารถนำมา ซึ่งสถานการณ์เช่นนี้ได้

#### Parallel Gateway

สามารถแยกแยะ หรือ บรรจบกัน ของ flows ได้ 

ในกรณีที่แยกออกจากกันมันจะแบ่ง flows ออกเป็นหลาย ๆ แบบ ไม่มีพารามิเตอร์สำหรับประเภท gateway นี้

ในกรณีของการบรรจบกัน รอจนกว่ากระแสที่เข้ามาทั้งหมดจะมาถึงองค์ประกอบถัดไป

![parallel gateway](https://raw.githubusercontent.com/espocrm/documentation/master/_static/images/administration/bpm/gateway-parallel.png)

หมายเหตุ:  gateways การแบ่งและการรวมกันต้องมีความสมดุล 

หมายเหตุ: หาก flows แบบคู่ขนานสิ้นสุดลง ด้วยเหตุผลบางประการ gateway ที่แยกกันจะไม่ได้รับการประมวลผล กระบวนการนี้จะถูกปิดกั้น หลีกเลี่ยง การออกแบบ flowchart  ที่สามารถนำมาซึ่งสถานการณ์เช่นนี้ได้

#### เหตุการณ์พื้นฐานของ Gateway

สามารถแยกเฉพาะ flows ได้ 

จะหยุด flow  จนกว่าเหตุการณ์ขาออกใด ๆ จะได้รับการกระตุ้น เหตุการณ์ที่ทริกเกอร์กำหนดให้มีการไหลเดี่ยว กิจกรรมขาออกอื่น ๆ ได้รับการปฏิเสธ เฉพาะเหตุการณ์ ระดับกลางเท่านั้น ที่สามารถอยู่ในส่วนอื่น ๆ ของกระแสลำดับที่ส่งออกได้


![event based gateway](https://raw.githubusercontent.com/espocrm/documentation/master/_static/images/administration/bpm/gateway-event-based.png)

### กิจกรรม

กิจกรรมจะแสดงเป็นสี่เหลี่ยมผืนผ้ากลม

#### งาน

งานสามารถดำเนินการดังต่อไปนี้:

* สร้างบันทึก - สร้างบันทึกใหม่ของประเภท entity ใด ๆ;
* สร้างบันทึกที่เกี่ยวข้อง - สร้างบันทึกใหม่ที่เกี่ยวข้องกับการบันทึกเป้าหมาย;
* อัปเดตบันทึกเป้าหมาย;
* อัปเดตบันทึกที่เกี่ยวข้อง - อัปเดตบันทึกหรือบันทึกที่เกี่ยวข้องกับบันทึกเป้าหมาย;
* อัปเดตบันทึกที่สร้าง - อัปเดตเขตข้อมูลที่เฉพาะเจาะจงของบันทึกที่สร้างขึ้นในกระบวนการปัจจุบัน;
* อัปเดตกระบวนการบันทึก - สามารถใช้เพื่อกำหนดกระบวนการเฉพาะผู้ใช้หรือทีมเฉพาะได้;
* การเชื่อมโยงไปยังบันทึกอื่นๆ - เชื่อมโยงบันทึกเป้าหมายกับบันทึกที่ระบุไว้เฉพาะเจาะจง;
* ยกเลิกการเชื่อมโยงจากบันทึกอื่นๆ - ยกเลิกการเชื่อมโยงบันทึกเป้าหมายจากบันทึกที่ระบุไว้เฉพาะเจาะจง;
* ใช้กฎการกำหนด - กำหนดเป้าหมายการบันทึก กระบวนการหรือบันทึกที่สร้างโดยกระบวนการตามกฎที่ระบุไว้เฉพาะเจาะจง;
* สร้างการแจ้งเตือน - สร้างการแจ้งเตือนในแอปสำหรับเฉพาะผู้ใช้;
* ทำตาม - ทำให้ผู้ใช้เฉพาะติดตามบันทึกเป้าหมาย บันทึกกระบวนการหรือบันทึกที่สร้างขึ้นโดยกระบวนการ;
* เรียกใช้คำสั่งการดำเนิน - เรียกใช้การทำงานของบริการแบบกำหนดเองที่นักพัฒนาซอฟต์แวร์ใช้

คำสั่งการดำเนินการที่พร้อมใช้งาน สำหรับงานเกือบจะเหมือนกันในคุณลักษณะ Workflow ดูรายละเอียดเพิ่มเติมเกี่ยวกับ [workflow's actions](workflows.md#actions).

#### ส่งข้อความงาน

ส่งข้อความอีเมลไปยังผู้รับที่เฉพาะเจาะจง

#### ผู้ใช้งาน

ให้ความยืดหยุ่นในการโต้ตอบกับผู้ใช้ ซึ่งจะหยุดการดำเนินการจนกว่าผู้ใช้ (ระบุอย่างชัดเจนหรือตามกฎการกำหนด) จะแก้ไขงานนั้นๆ การประมวลผลบันทึกงานของผู้ใช้ จะถูกสร้างขึ้นในระบบ โดยค่าเริ่มต้นจะมี 3 ประเภท ได้แก่ : อนุมัติ, รีวิว, สำเร็จ 

* ประเภทของการอนุมัติต้องให้ผู้ใช้เลือกระหว่าง "อนุมัติ" และ "ปฏิเสธ"
* ประเภทของรีวิวการตรวจทานมีเพียงหนึ่งตัวเลือก: 'ตรวจสอบแล้ว'
* ประเภทสำเร็จมีสองตัวเลือกคือ 'เสร็จสิ้น' และ 'ล้มเหลว'

ผู้ใช้ที่กำหนดให้กับกระบวนการที่สร้างขึ้น บันทึกงานของผู้ใช้จะได้รับการแจ้งเตือนในแอป โดยผู้ดูแลระบบสามารถเปิดใช้งานการแจ้งเตือนทางอีเมลได้

ผู้ใช้ยังสามารถเพิ่มกระบวนการผู้ใช้ dashlet งานบน dashboard เพื่อดูงานของผู้ใช้ในกระบวนการจริง

สามารถอ่านความละเอียดของงานที่ผู้ใช้ส่งผ่านภายใน gateways หรือเหตุการณ์ที่มีเงื่อนไขทำให้เกิดการแบ่งส่วนในกระบวน flow

#### งาน Script

ดำเนินการ script ใน  [espo-formula](formula.md) ภาษา. ตัวแปรที่กำหนดทั้งหมด (`$variableName`) จะถูกจัดเก็บและพร้อมใช้งานภายในกระบวนการนี้

### Flows

#### Sequence Flow

แสดงเป็นลูกศรทึบ การระบุลำดับองค์ประกอบของกระบวนการจะถูกดำเนินการ 

## เงื่อนไข

เหตุการณ์ที่มีเงื่อนไข, gateways จะแยกเฉพาะและรวมกัน มีเงื่อนไขที่กำหนด flow ของกระบวนการ 

UI มีความสามารถในการตรวจสอบเงื่อนไขสำหรับบันทึกต่อไปนี้:

* บันทึกเป้าหมาย;
* บันทึกเกี่ยวกับเป้าหมายผ่านความสัมพันธ์ แบบจำนวนมาก - ถึง - หนึ่ง และ ความสัมพันธ์แบบเด็ก - ถึง - ครอบครัว;
* บันทึกที่สร้างโดยกระบวนการผ่านงาน;;
* บันทึกงานของผู้ใช้ซึ่งช่วยให้สามารถตรวจสอบความละเอียดได้

นอกจากนี้ยังสามารถกำหนดเงื่อนไขได้จาก [Espo-formula](formula.md) ภาษา.

เงื่อนไขในเครื่องมือ BPM เหมือนกับคุณลักษณะใน Workflow [workflow's conditions](workflows.md#conditions).

## ตัวอย่าง

### ตัวอย่างที่ 1

![Example 1](https://raw.githubusercontent.com/espocrm/documentation/master/_static/images/administration/bpm/example-1.png)

### ตัวอย่างที่ 2

![Example 2](https://raw.githubusercontent.com/espocrm/documentation/master/_static/images/administration/bpm/example-2.png)

### ตัวอย่างที่ 3

![Example 3](https://raw.githubusercontent.com/espocrm/documentation/master/_static/images/administration/bpm/example-3.png)
