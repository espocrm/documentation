# Ldap Авторизация
В этом руководстве мы покажем, как настроить авторизацию LDAP для EspoCRM. Поехали!

Перейдите на сервер LDAP и создайте базовый DN для пользователей EspoCRM, например:
```
cn=espo-users,ou=users,dc=espo,dc=local
```

Мы должны создать системного пользователя, который будет иметь доступ к DN пользователей (“cn=espo-users,ou=users,dc=espo,dc=local”). Итак, полное DN для этого системного пользователя будет:

```
cn=LDAP User,cn=espo-users,ou=users,dc=espo,dc=local
```
Теперь мы можем добавить пользователя LDAP для доступа к EspoCRM. Например, Espo Tester с именем пользователя “tester” внутри DN “cn=espo-users,ou=users,dc=espo,dc=local”. Обратите внимание: чтобы использовать этот формат входа для EspoCRM, вы должны указать опции “Username Attribute” и “Base DN”.

Затем перейдите к настройкам аутентификации EspoCRM в панели администрирования, выберите метод `LDAP` и введите данные LDAP:

![1](https://raw.githubusercontent.com/espocrm/documentation/master/docs/_static/images/administration/ldap-authorization/ldap-configuration.png)

* Сервер – LDAP IP или имя сервера.
* Порт – порт подключения.
* Аутентификация – учетные данные для доступа к серверу LDAP.
 * Full User DN – полный DN пользователя системы, который позволяет искать других пользователей.
 * Пароль – пароль для доступа к серверу LDAP.
* Безопасность – протоколы SSL или TSL.
* Атрибут имени пользователя - атрибут для идентификации пользователя. Для Active Directory это может быть “userPrincipalName” или “sAMAccountName”.
* Account Canonical Form – тип вашей account canonical form. Есть 4 варианта:
 * Dn – форма в формате `CN=tester,CN=Espocrm,DC=company,DC=com`.
 * Username – форма `tester`.
 * Backslash – форма `COMPANY\tester`.
 * Principal – форма `tester@company.com`.
* Привязка по домену – если есть необходимость отформатировать имя пользователя в форме DN.
* Базовый домен – базовый DN по умолчанию, который используется для поиска пользователей.
* Фильтр логина пользователя – фильтр, который позволяет ограничивать пользователей, которые могут использовать EspoCRM. Например, `memberOf=cn=espoGroup,cn=espo-users,ou=users,dc=espo,dc=local`.
* Account Domain Name – домен, который используется для авторизации на сервере LDAP.
* Account Domain Name Short – короткий домен, который используется для авторизации на сервере LDAP.
* Попробовать отделить имя пользователя – возможность разделить имя пользователя и домен.
* Оптовые рефералы – должны ли рефералы следовать клиенту LDAP.
* Создать пользователя в EspoCRM – этот параметр позволяет EspoCRM создавать пользователя из LDAP.
 * Атрибут имени пользователя – LDAP атрибут, который используется для определения имени пользователя.
 * Атрибут фамилии пользователя – LDAP атрибут, который используется для определения фамилии пользователя. 
 * Атрибут должности пользователя – LDAP атрибут, который используется для определения названия должности пользователя.
 * Атрибут адреса эл. почты пользователя – LDAP атрибут, который используется для определения адреса эл. почты пользователя. 
 * Атрибут номера телефона пользователя – LDAP, который используется для определения номера телефона пользователя. 

Теперь перейдите на страницу входа и введите учетные данные пользователя.

![2](https://raw.githubusercontent.com/espocrm/documentation/master/docs/_static/images/administration/ldap-authorization/ldap-login.png)

Пользователь был аутентифицирован и автоматически создан в EspoCRM.

## Инструкции по настройке на основе вашего сервера:
* [Active Directory server](ldap-authorization-for-ad.md)
* [OpenLDAP server](ldap-authorization-for-openldap.md)

Вы можете прочитать больше информации о настройке LDAP на странице [Zend \ Ldap library] (https://zendframework.github.io/zend-ldap/intro/), так как EspoCRM использует эту библиотеку.
